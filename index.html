<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Ù„Ø¹Ø¨Ø© Ø±ÙƒØ¶ Ø­Ø³ÙŠÙ†</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: Arial; }
        #gameCanvas { display: none; background: #f0f0f0; }
        #startMenu { 
            text-align: center; margin-top: 100px; 
            background: white; padding: 20px; border-radius: 15px; 
            width: 300px; margin-left: auto; margin-right: auto;
            box-shadow: 0px 0px 20px rgba(0,0,0,0.2);
        }
        button { padding: 10px 20px; font-size: 20px; cursor: pointer; background: #28a745; color: white; border: none; border-radius: 5px; }
        .info { position: absolute; top: 10px; left: 10px; font-size: 20px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="startMenu">
        <h1>Ù„Ø¹Ø¨Ø© Ø±ÙƒØ¶ Ø­Ø³ÙŠÙ†</h1>
        <p>Ø§Ù„Ù…Ù‡Ø§Ù…: ØªØ¬Ù†Ø¨ Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚ ÙˆØ§Ø¬Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø·</p>
        <button onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
    </div>

    <div class="info" id="scoreBoard" style="display:none;">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let score = 0;
    let gameRunning = false;

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨
    const player = {
        x: 50,
        y: 200,
        width: 50,
        height: 80,
        color: '#FF5733'
    };

    function startGame() {
        document.getElementById('startMenu').style.display = 'none';
        document.getElementById('scoreBoard').style.display = 'block';
        canvas.style.display = 'block';
        canvas.width = window.innerWidth;
        canvas.height = 400;
        gameRunning = true;
        animate();
    }

    function drawPlayer() {
        // Ø±Ø³Ù… Ø¬Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
        ctx.fillStyle = player.color;
        ctx.fillRect(player.x, player.y, player.width, player.height);
        
        // ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø­Ø³ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù…ÙŠØµ
        ctx.fillStyle = "white";
        ctx.font = "14px Arial";
        ctx.fillText("Ø­Ø³ÙŠÙ†", player.x + 5, player.y + 40);
    }

    function animate() {
        if (!gameRunning) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Ø±Ø³Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚
        ctx.fillStyle = "#666";
        ctx.fillRect(0, 300, canvas.width, 100);

        drawPlayer();
        
        // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆÙ‡Ù…ÙŠØ§Ù‹ ÙƒØ£Ù†Ùƒ ØªØ±ÙƒØ¶
        score++;
        document.getElementById('scoreBoard').innerText = "Ø§Ù„Ù†Ù‚Ø§Ø·: " + score;

        requestAnimationFrame(animate);
    }

    // Ø§Ù„Ù‚ÙØ² Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø£Ùˆ Ø§Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯
    window.addEventListener('keydown', () => {
        if(player.y === 220) player.y -= 100; // Ø­Ø±ÙƒØ© Ù‚ÙØ² Ø¨Ø³ÙŠØ·Ø© Ø¬Ø¯Ø§Ù‹
        setTimeout(()=> player.y = 220, 500);
    });
</script>
</body>
</html>

            window.addEventListener('touchmove', handleTouch);
            setInterval(spawnEnemy, 1500);
            setInterval(autoShoot, 400);
            animate();
        }

        function autoShoot() {
            if(!gameActive) return;
            const b = new THREE.Mesh(new THREE.SphereGeometry(0.1, 8, 8), new THREE.MeshBasicMaterial({color: 0xffff00}));
            b.position.set(ship.position.x, ship.position.y, ship.position.z - 1);
            scene.add(b);
            bullets.push(b);
        }

        function spawnEnemy() {
            if(!gameActive) return;
            const enemy = new THREE.Mesh(new THREE.OctahedronGeometry(0.8), new THREE.MeshPhongMaterial({color: 0xff0066}));
            enemy.position.set((Math.random()-0.5)*20, (Math.random()-0.5)*10, -50);
            scene.add(enemy);
            enemies.push(enemy);
        }

        function handleTouch(e) {
            if(!gameActive) return;
            let x = (e.touches[0].clientX / window.innerWidth) * 2 - 1;
            let y = -(e.touches[0].clientY / window.innerHeight) * 2 + 1;
            ship.position.x = x * 10;
            ship.position.y = y * 5;
            camera.position.x = ship.position.x * 0.3;
        }

        function animate() {
            if(!gameActive) return;
            requestAnimationFrame(animate);

            stars.rotation.z += 0.001;

            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø±ØµØ§Øµ
            bullets.forEach((b, i) => {
                b.position.z -= 1;
                if(b.position.z < -60) { scene.remove(b); bullets.splice(i, 1); }
            });

            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø§ØµØ·Ø¯Ø§Ù…
            enemies.forEach((en, i) => {
                en.position.z += 0.4 + (score * 0.001);
                en.rotation.y += 0.05;

                // Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„Ø±ØµØ§Øµ
                bullets.forEach((b, bi) => {
                    if(en.position.distanceTo(b.position) < 1) {
                        scene.remove(en); enemies.splice(i, 1);
                        scene.remove(b); bullets.splice(bi, 1);
                        score += 10;
                        document.getElementById('score').innerText = score;
                    }
                });

                // Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨
                if(en.position.distanceTo(ship.position) < 1.2) {
                    health -= 20;
                    document.getElementById('health').innerText = health;
                    scene.remove(en); enemies.splice(i, 1);
                    if(health <= 0) gameOver();
                }

                if(en.position.z > 15) { scene.remove(en); enemies.splice(i, 1); }
            });

            renderer.render(scene, camera);
        }

        function gameOver() {
            gameActive = false;
            document.getElementById('overlay').style.display = 'flex';
        }

        init();
    </script>
</body>
</html>
            animate();
        }

        // 5. Ù…Ø­Ø±Ùƒ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† (Optimized for High Refresh Rates)
        function animate() {
            requestAnimationFrame(animate);
            
            const time = performance.now() * 0.001;

            // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø§Ù„Ø£ÙØ§ØªØ§Ø± (Ø¯ÙˆØ±Ø§Ù† ÙˆØªÙˆØ³Ø¹)
            player.rotation.y += 0.01;
            player.rotation.z += 0.01;
            player.scale.set(
                1 + Math.sin(time * 5) * 0.1,
                1 + Math.sin(time * 5) * 0.1,
                1 + Math.sin(time * 5) * 0.1
            );

            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„Ø¥Ø¹Ø·Ø§Ø¡ Ø´Ø¹ÙˆØ± Ø¨Ø§Ù„Ø¹Ù…Ù‚ 3D
            camera.position.x = Math.sin(time * 0.5) * 2;
            camera.lookAt(player.position);

            renderer.render(scene, camera);

            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù€ FPS Ø¨Ø¯Ù‚Ø©
            frames++;
            if (performance.now() > lastTime + 1000) {
                document.getElementById('fps-counter').innerText = `FPS: ${Math.round((frames * 1000) / (performance.now() - lastTime))}`;
                frames = 0;
                lastTime = performance.now();
            }
        }

        // Ø§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù„Ù…Ø³/Ø§Ù„Ù…Ø§ÙˆØ³ Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙÙŠ Ø§Ù„ÙØ¶Ø§Ø¡
        window.addEventListener('mousemove', (e) => {
            const x = (e.clientX / window.innerWidth) * 2 - 1;
            const y = -(e.clientY / window.innerHeight) * 2 + 1;
            player.position.x = x * 3;
            player.position.y = y * 2;
        });

        init();
    </script>
</body>
</html>
            }

            draw() {
                let sx = (this.x / this.z) * canvas.width + canvas.width / 2;
                let sy = (this.y / this.z) * canvas.height + canvas.height / 2;
                let r = (1 - this.z / canvas.width) * 3;

                ctx.beginPath();
                ctx.arc(sx, sy, r, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                // Ø¥Ø¶Ø§ÙØ© ÙˆÙ‡Ø¬ Ù„ÙƒÙ„ Ù†Ø¬Ù…Ø©
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
            }
        }

        function init() {
            for (let i = 0; i < 600; i++) stars.push(new Star());
        }

        function animate() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.2)"; // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø°ÙŠÙ„ (Trail)
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            stars.forEach(star => {
                star.update();
                star.draw();
            });

            if(active) {
                score++;
                document.getElementById('scr').innerText = score;
            }
            requestAnimationFrame(animate);
        }

        function startEngine() {
            active = true;
            document.getElementById('overlay').style.opacity = '0';
            document.getElementById('hud').style.opacity = '1';
            document.getElementById('ambience').play();
            setTimeout(() => {
                document.getElementById('overlay').style.display = 'none';
            }, 1500);
        }

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        init();
        animate();
    </script>
</body>
</html>

        // ØªØ£Ø«ÙŠØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„
        window.onload = () => {
            document.getElementById('p-bar').style.width = '100%';
            setTimeout(() => {
                document.getElementById('splash').style.display = 'none';
                document.getElementById('game-ui').style.display = 'flex';
                initGrid();
            }, 2500);
        };

        function initGrid() {
            const grid = document.getElementById('grid');
            for (let i = 0; i < 36; i++) {
                const g = document.createElement('div');
                g.className = 'gem';
                g.dataset.id = i;
                g.innerHTML = gems[Math.floor(Math.random() * gems.length)];
                g.onclick = () => handleGemClick(g);
                grid.appendChild(g);
            }
        }

        function handleGemClick(g) {
            if (!selected) {
                selected = g;
                g.classList.add('selected');
            } else {
                let id1 = parseInt(selected.dataset.id);
                let id2 = parseInt(g.dataset.id);
                
                if (Math.abs(id1 - id2) === 1 || Math.abs(id1 - id2) === 6) {
                    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¬ÙˆØ§Ù‡Ø±
                    let tmp = selected.innerHTML;
                    selected.innerHTML = g.innerHTML;
                    g.innerHTML = tmp;
                    
                    moves--;
                    score += 50; // Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„ØªØ¨Ø³ÙŠØ·
                    document.getElementById('moves').innerText = moves;
                    document.getElementById('score').innerText = score;
                    document.getElementById('sound-pop').play();
                    
                    checkStatus();
                }
                selected.classList.remove('selected');
                selected = null;
            }
        }

        function checkStatus() {
            const screen = document.getElementById('result-screen');
            const title = document.getElementById('result-title');
            if (score >= 500) {
                title.innerText = "ÙÙˆØ² Ù…Ù„ÙƒÙŠ! ğŸ‘‘";
                screen.style.display = 'flex';
            } else if (moves <= 0) {
                title.innerText = "Ø®Ø³Ø§Ø±Ø©! ğŸ’”";
                title.style.color = "#ff4444";
                screen.style.display = 'flex';
            }
        }
    </script>
</body>
</html>
            let id1 = parseInt(selectedCell.dataset.id);
            let id2 = parseInt(cell.dataset.id);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬ÙˆØ§Ø± (ØªØ¨Ø¯ÙŠÙ„)
            if (isAdjacent(id1, id2)) {
                swap(selectedCell, cell);
                moves--;
                document.getElementById('moves').innerText = moves;
                checkMatches();
            }
            
            selectedCell.classList.remove('selected');
            selectedCell = null;
            checkGameOver();
        }
    }

    function isAdjacent(id1, id2) {
        const diff = Math.abs(id1 - id2);
        return diff === 1 || diff === 6;
    }

    function swap(c1, c2) {
        let temp = c1.innerHTML;
        c1.innerHTML = c2.innerHTML;
        c2.innerHTML = temp;
    }

    function checkMatches() {
        // Ù…Ù†Ø·Ù‚ Ù…Ø¨Ø³Ø· Ù„Ù…Ø³Ø­ Ø§Ù„Ù…ØªØ´Ø§Ø¨Ù‡Ø§Øª (Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø¹Ø±Ø¶)
        // ÙÙŠ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø§Ù„ÙƒÙˆØ¯ ÙŠÙƒÙˆÙ† Ø£Ø¹Ù‚Ø¯ØŒ Ù„ÙƒÙ† Ù‡Ø°Ø§ Ø³ÙŠØ¹Ø·ÙŠÙƒ Ø§Ù„Ø¥Ø­Ø³Ø§Ø³ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
        score += 50;
        document.getElementById('score').innerText = score;
        document.getElementById('pop').play();
    }

    function checkGameOver() {
        if (score >= 500) showEnd("ÙÙˆØ² Ø³Ø§Ø­Ù‚!", "#00f2ff");
        else if (moves <= 0) showEnd("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø­Ø±ÙƒØ§Øª!", "#ff0044");
    }

    function showEnd(title, color) {
        const screen = document.getElementById('msg-screen');
        screen.style.display = 'flex';
        document.getElementById('res-title').innerText = title;
        document.getElementById('res-title').style.color = color;
    }

    createBoard();
</script>
</body>
</html>
                    endGame(false, "Ù„Ù…Ø³Øª Ø§Ù„Ø®Ø·Ø±! Ø®Ø³Ø±Øª.");
                });
            }
        }

        function createElem(type, text, action) {
            const el = document.createElement('div');
            el.className = 'target ' + type;
            el.innerText = text;
            const x = Math.random() * (window.innerWidth - 80);
            const y = Math.random() * (window.innerHeight - 150) + 100;
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            el.onclick = action;
            area.appendChild(el);
        }

        function endGame(isWin, msg) {
            clearInterval(gameTimer);
            const screen = document.getElementById('msg-screen');
            screen.style.display = 'flex';
            document.getElementById('status-title').innerText = isWin ? "Ù…Ø¨Ø±ÙˆÙƒ!" : "Ø®Ø³Ø±Øª!";
            document.getElementById('status-title').style.color = isWin ? "#00f2ff" : "#ff0044";
            document.getElementById('status-msg').innerText = msg;
        }

        function resetGame() { startGame(); }
        
        // Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© ÙÙˆØ±Ø§Ù‹
        startGame();
    </script>
</body>
</html>
                
                screen.removeChild(hussain);
                setTimeout(createHussain, 100); 
            };

            screen.appendChild(hussain);
        }

        function showRipple(x, y) {
            const r = document.createElement('div');
            r.className = 'ripple';
            r.style.left = x + 'px';
            r.style.top = y + 'px';
            document.body.appendChild(r);
            setTimeout(() => r.remove(), 600);
        }
    </script>
</body>
</html>

    <script>
        function triggerPortal() {
            const portal = document.querySelector('.p-portal');
            // ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒÙŠ Ù„Ù„Ø¨ÙˆØ§Ø¨Ø©
            portal.style.transform = 'translateX(-50%) scale(1.2)';
            setTimeout(() => portal.style.transform = 'translateX(-50%) scale(1)', 200);
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù‡ØªØ²Ø§Ø² Ø¨Ø³ÙŠØ· (Ø¥Ø°Ø§ ÙƒØ§Ù† ÙŠØ¯Ø¹Ù…Ù‡ Ø§Ù„Ø¬Ù‡Ø§Ø²)
            if (window.navigator.vibrate) window.navigator.vibrate(50);
        }

        function simulateNotification() {
            const ripple = document.getElementById('ripple');
            const notif = document.getElementById('notification');
            const sound = document.getElementById('notifSound');

            // 1. ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ù‡Ø§Ø¯Ø¦
            sound.play();

            // 2. ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø¨Ø¶Ø© Ø§Ù„Ù†ÙŠÙˆÙ†ÙŠØ© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø©
            ripple.style.animation = 'none';
            void ripple.offsetWidth; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
            ripple.style.animation = 'ripple-animation 1s ease-out';

            // 3. Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            notif.style.display = 'block';
            document.getElementById('notif-text').innerText = "Ø´Ø®Øµ Ù…Ø§ Ù…Ø¹Ø¬Ø¨ Ø¨Ø¨Ø±ÙˆÙØ§ÙŠÙ„Ùƒ ÙÙŠ Ø¹Ø§Ù„Ù… Pulse!";
            
            setTimeout(() => { notif.style.display = 'none'; }, 5000);
        }
    </script>
</body>
</html>
                portal.style.boxShadow = '0 0 25px var(--penta-purple)';
            } else {
                portal.innerText = 'P';
                portal.style.boxShadow = '0 0 25px var(--penta-cyan)';
            }
        }
    </script>
</body>
</html>
